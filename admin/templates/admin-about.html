<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard - About</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
    <style>
      body {
        background: #1f1f1f;
        color: #ffffff;
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      }
      .highlight {
        color: #ececec;
      }
      .btn-primary {
        background: #232323;
        border: 1px solid #ececec;
        color: #ececec;
        transition: all 0.3s ease;
      }
      .btn-primary:hover {
        background: #2c2c2c;
        border-color: #ffffff;
        color: #ffffff;
        transform: translateY(-2px);
      }
      .sidebar {
        height: 100vh;
        background: #232323;
        border-right: 2px solid #2c2c2c;
        padding-top: 20px;
        box-shadow: 2px 0 10px rgba(0,0,0,0.3);
      }
      .sidebar a {
        color: #ececec;
        text-decoration: none;
        padding: 12px 20px;
        display: flex;
        align-items: center;
        gap: 10px;
        font-weight: 500;
        transition: all 0.3s ease;
        border-radius: 8px;
        margin: 2px 10px;
      }
      .sidebar a i {
        width: 20px;
        text-align: center;
      }
      .sidebar a:hover, .sidebar a.active {
        background: #2c2c2c;
        color: #ffffff;
        transform: translateX(5px);
        border-left: 3px solid #ececec;
      }
      .card {
        border: none;
        border-radius: 15px;
        background: #232323;
        box-shadow: 0 5px 20px rgba(0,0,0,0.5);
        transition: all 0.3s ease;
        overflow: hidden;
      }
      .card:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 30px rgba(0,0,0,0.7);
      }
      .card-header {
        background: #2c2c2c;
        color: #ffffff;
        font-weight: 600;
        padding: 15px 20px;
        border: none;
        border-bottom: 1px solid #393939;
      }
      .form-label {
        font-weight: 600;
        color: #ececec;
        margin-bottom: 8px;
      }
      .form-control {
        background: #2c2c2c;
        border: 1px solid #393939;
        color: #ffffff;
      }
      .form-control:focus {
        background: #2c2c2c;
        border-color: #ececec;
        color: #ffffff;
      }
      .table {
        margin-bottom: 0;
        color: #ffffff;
      }
      .table thead th {
        background-color: #2c2c2c;
        border-bottom: 2px solid #393939;
        font-weight: 600;
        text-transform: uppercase;
        font-size: 0.85rem;
        letter-spacing: 0.5px;
        color: #ececec;
      }
      .table tbody tr {
        background: #232323;
      }
      .table tbody tr:hover {
        background: #2c2c2c;
      }
      .btn-sm {
        padding: 6px 12px;
        font-size: 0.85rem;
        border-radius: 6px;
      }
      .bio-preview {
        background: #2c2c2c;
        padding: 20px;
        border-radius: 10px;
        border-left: 4px solid #ececec;
        line-height: 1.8;
        color: #ececec;
      }
      .actions-cell {
        white-space: nowrap;
      }
      .page-header {
        background: #232323;
        color: white;
        border-radius: 15px;
        padding: 25px 30px;
        margin-bottom: 30px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        border: 1px solid #393939;
      }
      .section-divider {
        height: 2px;
        background: linear-gradient(90deg, transparent, #ececec, transparent);
        margin: 30px 0;
        border: none;
      }
      .badge {
        font-weight: 600;
        padding: 6px 12px;
        font-size: 0.85rem;
        background: #2c2c2c;
        color: #ececec;
        border: 1px solid #393939;
      }
      .badge.bg-primary {
        background: #2c2c2c !important;
        color: #ececec !important;
      }
      .badge.bg-secondary {
        background: #2c2c2c !important;
        color: #ececec !important;
      }
      .card-body {
        padding: 25px;
        background: #232323;
        color: #ffffff;
      }
      .btn-light {
        background: #2c2c2c;
        border: 1px solid #393939;
        color: #ececec;
      }
      .btn-light:hover {
        background: #393939;
        border-color: #ececec;
        color: #ffffff;
      }
      .btn-danger {
        background: #2c2c2c;
        border: 1px solid #4a4a4a;
        color: #ececec;
      }
      .btn-danger:hover {
        background: #393939;
        border-color: #ececec;
        color: #ffffff;
      }
      .btn-warning {
        background: #2c2c2c;
        border: 1px solid #4a4a4a;
        color: #ececec;
      }
      .btn-warning:hover {
        background: #393939;
        border-color: #ececec;
        color: #ffffff;
      }
      .btn-secondary {
        background: #2c2c2c;
        border: 1px solid #393939;
        color: #ececec;
      }
      .btn-secondary:hover {
        background: #393939;
        border-color: #ececec;
        color: #ffffff;
      }
      .modal-content {
        background: #232323;
        color: #ffffff;
        border: 1px solid #393939;
      }
      .modal-header {
        background: #2c2c2c;
        border-bottom: 1px solid #393939;
      }
      .modal-footer {
        border-top: 1px solid #393939;
      }
      .modal-body {
        background: #232323;
      }
      .alert {
        border: 1px solid #393939;
      }
      .alert-success {
        background: #2c2c2c;
        border-color: #4a4a4a;
        color: #ececec;
      }
      .alert-danger {
        background: #2c2c2c;
        border-color: #4a4a4a;
        color: #ececec;
      }
      .alert-info {
        background: #2c2c2c;
        border-color: #4a4a4a;
        color: #ececec;
      }
      .text-muted {
        color: #9a9a9a !important;
      }
      .text-primary {
        color: #ececec !important;
      }
      .table-light {
        background: #2c2c2c !important;
      }
      .table-striped tbody tr:nth-of-type(odd) {
        background: #2c2c2c;
      }
      .table-hover tbody tr:hover {
        background: #2c2c2c;
      }
      .bg-light {
        background: #2c2c2c !important;
        color: #ececec !important;
      }
      .contact-info-item {
        background: #2c2c2c;
        border-left: 4px solid #ececec;
      }
    </style>
</head>
<body>

<div class="container-fluid">
    <div class="row">

        <!-- Sidebar -->
        <nav class="col-md-2 d-none d-md-block sidebar">
            <div class="position-sticky">
                <div class="text-center mb-4">
                    <h4 class="highlight mb-0">
                        <i class="bi bi-shield-check"></i> Admin Panel
                    </h4>
                    <small class="text-muted">Dashboard</small>
                </div>
                <hr>
                <ul class="nav flex-column">
                    <li class="nav-item">
                        <a class="nav-link" href="/admin-home">
                            <i class="bi bi-house-door"></i> Home
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" href="/admin-about">
                            <i class="bi bi-person"></i> About
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/admin-experience">
                            <i class="bi bi-briefcase"></i> Experience
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/admin-education">
                            <i class="bi bi-mortarboard"></i> Education
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/admin-certification">
                            <i class="bi bi-award"></i> Certification
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/admin-project">
                            <i class="bi bi-folder"></i> Project
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/admin-contact">
                            <i class="bi bi-envelope"></i> Contact
                        </a>
                    </li>
                    <li class="nav-item mt-4">
                        <a class="nav-link" href="/logout">
                            <i class="bi bi-box-arrow-right"></i> Logout
                        </a>
                    </li>
                </ul>
            </div>
        </nav>

      <!-- Main Content -->
      <main class="col-md-10 py-4 px-md-4">
        <!-- Page Header -->
        <div class="page-header">
          <div class="d-flex justify-content-between align-items-center">
            <div>
              <h1 class="mb-2" style="font-size: 2rem; font-weight: 700;">
                <i class="bi bi-person-circle"></i> Manage About Section
              </h1>
              <p class="mb-0 opacity-75">Manage your bio, skills, and resume information</p>
            </div>
            <div class="text-end">
              <i class="bi bi-file-person" style="font-size: 4rem; opacity: 0.3;"></i>
            </div>
          </div>
        </div>
        
        <!-- Flash Messages -->
        {% with messages = get_flashed_messages(with_categories=true) %}
          {% if messages %}
            {% for category, message in messages %}
              <div class="alert alert-{{ 'danger' if category == 'error' else 'success' }} alert-dismissible fade show" role="alert">
                <i class="bi bi-{{ 'exclamation-triangle' if category == 'error' else 'check-circle' }}"></i> {{ message }}
                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
              </div>
            {% endfor %}
          {% endif %}
        {% endwith %}

        <!-- Manage Bio Heading Card -->
        <div class="card">
          <div class="card-header">
            <i class="bi bi-type-h1"></i> Bio Heading
          </div>
          <div class="card-body">
            {% if heading %}
            <div class="bio-preview mb-4">
              <p class="mb-0" style="font-size: 1.1rem; color: #FFFFFF;">{{ heading }}</p>
            </div>
            {% else %}
            <div class="alert alert-info mb-4">
              <i class="bi bi-info-circle"></i> No heading added yet. Click "Edit Heading" to add one.
            </div>
            {% endif %}
            <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#editBioHeadingModal" data-heading="{{ heading|e }}">
              <i class="bi bi-pencil-square"></i> {{ 'Edit Heading' if heading else 'Add Heading' }}
            </button>
          </div>
        </div>

        <!-- Edit Bio Heading Modal -->
        <div
          class="modal fade" id="editBioHeadingModal" tabindex="-1" aria-labelledby="editBioHeadingModalLabel" aria-hidden="true">
          <div class="modal-dialog">
            <form method="post" action="{{ url_for('admin_about') }}">
              <div class="modal-content">
                <div class="modal-header">
                  <h5 class="modal-title highlight" id="editBioHeadingModalLabel">
                    <i class="bi bi-type-h1"></i> Edit Heading
                  </h5>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                  <div class="mb-3">
                    <label for="editedBioHeading" class="form-label">Bio</label>
                    <textarea
                      class="form-control"
                      id="editedBioHeading"
                      name="edited_bio_heading"
                      rows="4"
                      required
                    >{{ heading }}</textarea>
                  </div>
                </div>
                <div class="modal-footer">
                  <button type="submit" class="btn btn-primary">
                    <i class="bi bi-check-circle"></i> Save Heading
                  </button>
                  <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                </div>
              </div>
            </form>
          </div>
        </div>

        <hr class="section-divider">
        
        <!-- Manage Bio Card -->
        <div class="card">
          <div class="card-header">
            <i class="bi bi-file-text"></i> Bio
          </div>
          <div class="card-body">
            {% if bio %}
            <div class="bio-preview mb-4">
              <p class="mb-0" style="font-size: 1rem; color: #FFFFFF; line-height: 1.8;">{{ bio }}</p>
            </div>
            {% else %}
            <div class="alert alert-info mb-4">
              <i class="bi bi-info-circle"></i> No bio added yet. Click "Edit Bio" to add one.
            </div>
            {% endif %}
            <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#editBioModal" data-bio="{{ bio|e }}">
              <i class="bi bi-pencil-square"></i> {{ 'Edit Bio' if bio else 'Add Bio' }}
            </button>
          </div>
        </div>

        <!-- ═════ Edit Bio Modal ═════ -->
        <div class="modal fade" id="editBioModal" tabindex="-1" aria-labelledby="editBioModalLabel" aria-hidden="true">
          <div class="modal-dialog">
            <form method="post" action="{{ url_for('admin_about') }}">
              <div class="modal-content">
                <div class="modal-header">
                  <h5 class="modal-title highlight" id="editBioModalLabel">
                    <i class="bi bi-file-text"></i> Edit Bio
                  </h5>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                  <div class="mb-3">
                    <label for="editedBio" class="form-label">Bio</label>
                    <textarea class="form-control" id="editedBio" name="edited_bio" rows="4" required>{{ bio }}</textarea>
                  </div>
                </div>
                <div class="modal-footer">
                  <button type="submit" class="btn btn-primary">
                    <i class="bi bi-check-circle"></i> Save Bio
                  </button>
                  <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                </div>
              </div>
            </form>
          </div>
        </div>

        <hr class="section-divider">
        
        <div class="card">
          <div class="card-header d-flex justify-content-between align-items-center">
            <span><i class="bi bi-tags"></i> Manage Skills</span>
            <button type="button" class="btn btn-light btn-sm" data-bs-toggle="modal" data-bs-target="#addSkillModal">
              <i class="bi bi-plus-circle"></i> Add New Skill
            </button>
          </div>
          <div class="card-body">
            {% if skills %}
            <div class="table-responsive">
              <table class="table">
                <thead>
                  <tr>
                    <th>#</th>
                    <th>Title</th>
                    <th>Description</th>
                    <th>Category</th>
                    <th>Percentage</th>
                    <th style="width:180px">Actions</th>
                  </tr>
                </thead>
                <tbody>
                  {% for skill in skills %}
                  <tr>
                    <td>{{ loop.index }}</td>
                    <td><strong>{{ skill.Skill }}</strong></td>
                    <td>{{ skill.Description }}</td>
                    <td><span class="badge bg-info">{{ skill.category if 'category' in skill else 'Cloud & DevOps' }}</span></td>
                    <td><span class="badge bg-primary">{{ skill.percentage }}%</span></td>
                    <td class="actions-cell">
                      <button class="btn btn-sm btn-primary me-1 edit-btn" data-index="{{ loop.index0 }}" data-title="{{ skill.Skill|e }}" data-desc="{{ skill.Description|e }}" data-pct="{{ skill.percentage }}" data-category="{{ skill.category if 'category' in skill else 'Cloud & DevOps' }}" data-bs-toggle="modal" data-bs-target="#editSkillModal">
                        <i class="bi bi-pencil"></i> Edit
                      </button>
                      <button class="btn btn-sm btn-danger delete-btn" data-index="{{ loop.index0 }}" data-bs-toggle="modal" data-bs-target="#deleteSkillModal">
                        <i class="bi bi-trash"></i> Delete
                      </button>
                    </td>
                  </tr>
                  {% endfor %}
                </tbody>
              </table>
            </div>
            {% else %}
            <div class="text-center py-5">
              <i class="bi bi-inbox" style="font-size: 3rem; color: #dee2e6;"></i>
              <p class="text-muted mt-3">No skills added yet. Click "Add New Skill" to get started.</p>
            </div>
            {% endif %}
          </div>
        </div>

        <!-- ───── Add Skill Modal ───── -->
        <div
          class="modal fade" id="addSkillModal" tabindex="-1" aria-hidden="true">
          <div class="modal-dialog">
            <form method="post" action="{{ url_for('admin_about') }}">
              <div class="modal-content">
                <div class="modal-header">
                  <h5 class="modal-title highlight">
                    <i class="bi bi-plus-circle"></i> Add New Skill
                  </h5>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                  <div class="mb-3">
                    <label for="newTitle" class="form-label">Title</label>
                    <input type="text" class="form-control" id="newTitle" name="new_title" required>
                  </div>
                  <div class="mb-3">
                    <label for="newDescription" class="form-label">Description</label>
                    <textarea class="form-control" id="newDescription" name="new_description" rows="3" required></textarea>
                  </div>
                  <div class="mb-3">
                    <label for="newPercentage" class="form-label">Percentage</label>
                    <input type="number" class="form-control" id="newPercentage" name="new_percentage" min="0" max="100" required>
                  </div>
                  <div class="mb-3">
                    <label for="newCategory" class="form-label">Category</label>
                    <select class="form-control" id="newCategory" name="new_category" required>
                      <option value="">Select Category</option>
                      <option value="Cloud & DevOps">Cloud & DevOps</option>
                      <option value="Web Development">Web Development</option>
                    </select>
                  </div>
                </div>
                <div class="modal-footer">
                  <button type="submit" class="btn btn-primary">
                    <i class="bi bi-check-circle"></i> Save Skill
                  </button>
                  <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                </div>
              </div>
            </form>
          </div>
        </div>

        <!-- Edit Skill Modal -->
        <div class="modal fade" id="editSkillModal" tabindex="-1" aria-hidden="true">
          <div class="modal-dialog">
            <form method="post" action="{{ url_for('admin_about') }}">
              <div class="modal-content">
                <div class="modal-header">
                  <h5 class="modal-title highlight">
                    <i class="bi bi-pencil"></i> Edit Skill
                  </h5>
                  <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                  <input type="hidden" name="edit_index" id="editSkillIndex">
                  <div class="mb-3">
                    <label for="editedTitle" class="form-label">Title</label>
                    <input type="text" class="form-control" id="editedTitle" name="edited_skill" required>
                  </div>
                  <div class="mb-3">
                    <label for="editedDescription" class="form-label">Description</label>
                    <textarea class="form-control" id="editedDescription" name="edited_description" rows="3" required></textarea>
                  </div>
                  <div class="mb-3">
                    <label for="editedPercentage" class="form-label">Percentage</label>
                    <input type="number" class="form-control" id="editedPercentage" name="edited_percentage" min="0" max="100" required>
                  </div>
                  <div class="mb-3">
                    <label for="editedCategory" class="form-label">Category</label>
                    <select class="form-control" id="editedCategory" name="edited_category" required>
                      <option value="">Select Category</option>
                      <option value="Cloud & DevOps">Cloud & DevOps</option>
                      <option value="Web Development">Web Development</option>
                    </select>
                  </div>
                </div>
                <div class="modal-footer">
                  <button type="submit" class="btn btn-primary">
                    <i class="bi bi-check-circle"></i> Update Skill
                  </button>
                  <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                </div>
              </div>
            </form>
          </div>
        </div>

        <!-- Delete Skill Confirmation Modal -->
        <div class="modal fade" id="deleteSkillModal" tabindex="-1" aria-hidden="true">
          <div class="modal-dialog">
            <form method="post" action="{{ url_for('admin_about') }}">
              <div class="modal-content">
                <div class="modal-header bg-danger text-white">
                  <h5 class="modal-title">
                    <i class="bi bi-exclamation-triangle"></i> Confirm Delete
                  </h5>
                  <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                  <p>Are you sure you want to delete this skill? This action cannot be undone.</p>
                  <input type="hidden" name="delete_index" id="deleteSkillIndex">
                </div>
                <div class="modal-footer">
                  <button type="submit" class="btn btn-danger">
                    <i class="bi bi-trash"></i> Delete
                  </button>
                  <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                </div>
              </div>
            </form>
          </div>
        </div>

        <hr class="section-divider">
        
        <!-- Resume Upload -->
        <div class="card">
          <div class="card-header">
            <i class="bi bi-file-earmark-pdf"></i> Manage Resume
          </div>
          <div class="card-body">
            {% if current_resume %}
            <div class="mb-4 p-3 bg-light rounded">
              <p class="mb-2"><strong><i class="bi bi-file-earmark-pdf"></i> Current Resume:</strong> <span class="text-primary">{{ current_resume }}</span></p>
              <p class="mb-0 text-muted small"><i class="bi bi-info-circle"></i> File Type: <span class="badge bg-secondary">{{ resume_type }}</span></p>
            </div>
            {% else %}
            <div class="alert alert-info mb-4">
              <i class="bi bi-info-circle"></i> No resume uploaded yet. Click "Upload Resume" to add one.
            </div>
            {% endif %}
            <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#uploadResumeModal">
              <i class="bi bi-upload"></i> Upload Resume
            </button>
          </div>
        </div>

        <!-- Upload Resume Modal -->
        <div class="modal fade" id="uploadResumeModal" tabindex="-1" aria-hidden="true">
          <div class="modal-dialog">
            <form method="post" action="{{ url_for('admin_about') }}" enctype="multipart/form-data">
              <div class="modal-content">
                <div class="modal-header">
                  <h5 class="modal-title highlight">
                    <i class="bi bi-upload"></i> Upload Resume
                  </h5>
                  <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                  <div class="mb-3">
                    <label for="resumeFile" class="form-label">Select Resume File</label>
                    <input type="file" class="form-control" id="resumeFile" name="resume_file" accept=".pdf,.txt" required>
                    <div class="form-text">Accepted formats: PDF (.pdf) or Text (.txt)</div>
                  </div>
                  <div class="alert alert-info">
                    <small><i class="bi bi-info-circle"></i> The uploaded file will replace the existing resume if one exists.</small>
                  </div>
                </div>
                <div class="modal-footer">
                  <button type="submit" class="btn btn-primary">
                    <i class="bi bi-check-circle"></i> Upload Resume
                  </button>
                  <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                </div>
              </div>
            </form>
          </div>
        </div>


      </main>
    </div>
  </div>

  <!-- Bootstrap JS Bundle (with Popper) -->
  <script
    src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"
  ></script>

  <!-- Pre-fill the modal textarea on open -->
  <script>
    const editBioHeadingModal = document.getElementById('editBioHeadingModal');
    editBioHeadingModal.addEventListener('show.bs.modal', (event) => {
      const button = event.relatedTarget;
      const heading = button.getAttribute('data-heading') || '';
      editBioHeadingModal.querySelector('#editedBioHeading').value = heading;
    });
  </script>

  <!-- Prefill Script -->
  <script>
    const editBioModal = document.getElementById('editBioModal');
    editBioModal.addEventListener('show.bs.modal', event => {
      const btn = event.relatedTarget;
      const bio = btn.getAttribute('data-bio') || '';
      editBioModal.querySelector('#editedBio').value = bio;
    });

    // Edit modal prefill
    document.getElementById('editSkillModal').addEventListener('show.bs.modal', event => {
      const btn = event.relatedTarget;
      document.getElementById('editSkillIndex').value = btn.dataset.index;
      document.getElementById('editedTitle').value = btn.dataset.title;
      document.getElementById('editedDescription').value = btn.dataset.desc;
      document.getElementById('editedPercentage').value = btn.dataset.pct;
      document.getElementById('editedCategory').value = btn.dataset.category || 'Cloud & DevOps';
    });

    // Delete modal prefill
    document.getElementById('deleteSkillModal').addEventListener('show.bs.modal', event => {
      document.getElementById('deleteSkillIndex').value = event.relatedTarget.dataset.index;
    });
  </script>

</body>
</html>






